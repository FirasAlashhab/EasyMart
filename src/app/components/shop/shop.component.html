<div class="container">
  <div class="overlay" *ngIf="this.loading"></div>
  <div
    *ngIf="this.loading"
    role="status"
    class="spinner-border text-light loading"
  >
    <span class="sr-only">Loading...</span>
  </div>
  <div class="row">
    <section class="col-3 mt-4">
      <h5 class="ms-3 mt-1 mb-3 text-light">Sort By</h5>
      <div class="select" data-bs-theme="dark">
        <select
          class="form-select mb-3 text-light"
          style="
            background-color: rgb(50, 50, 50);
            border: 1px solid rgb(30, 30, 30);
            outline: none;
            box-shadow: none;
          "
          (change)="onSortSelected($event)"
        >
          <option *ngFor="let sort of sortOptions" [value]="sort">
            {{ sort.name }}
          </option>
        </select>
      </div>
      <h5 class="ms-3 text-light">Brands</h5>
      <ul class="list-group my-3">
        <li
          class="list-group-item text-light mb-2"
          style="
            border: 1px solid rgb(30, 30, 30);
            background-color: rgb(50, 50, 50);
            cursor: pointer;
            font-weight: 700;
          "
          (click)="resetBrandFilter()"
        >
          Reset Brand Filter
        </li>
        <li
          [class.active]="brand.name == this.brandNameSelected"
          [value]="brand.id"
          *ngFor="let brand of productBrands"
          class="list-group-item text-light"
          style="
            border: 1px solid rgb(30, 30, 30);
            background-color: rgb(50, 50, 50);
            cursor: pointer;
          "
          (click)="onBrandSelected(brand.name)"
        >
          {{ brand.name }}
        </li>
      </ul>
      <h5 class="ms-3 text-light mt-4">Types</h5>
      <ul class="list-group my-3">
        <li
          class="list-group-item text-light mb-2"
          style="
            border: 1px solid rgb(30, 30, 30);
            background-color: rgb(50, 50, 50);
            cursor: pointer;
            font-weight: 700;
          "
          (click)="resetTypeFilter()"
        >
          Reset Type Filter
        </li>
        <li
          [class.active]="type.name == this.typeNameSelected"
          [value]="type.id"
          (click)="onTypeSelected(type.name)"
          *ngFor="let type of productTypes"
          class="list-group-item text-light"
          style="
            border: 1px solid rgb(30, 30, 30);
            background-color: rgb(50, 50, 50);
            cursor: pointer;
          "
        >
          {{ type.name }}
        </li>
      </ul>
    </section>

    <section class="col-9" style="position: relative">
      <div
        class="pagination text-light d-flex justify-content-center"
        *ngIf="products.length !== 0"
        style="
          position: absolute;
          left: 50%;
          transform: translateX(-59%);
          bottom: -2%;
        "
      >
        <pagination-controls
          previousLabel="&lsaquo;"
          nextLabel="&rsaquo;"
          (pageChange)="onPageChanged($event)"
        ></pagination-controls>
      </div>
      <div class="d-flex justify-content-between align-items-center pb-2">
        <h5 class="ms-31 mt-3 text-light" *ngIf="products.length !== 0">
          Showing
          <strong
            >{{ (this.pageNumber - 1) * this.pageSize + 1 }} -
            {{
              pageNumber * pageSize < totalCount
                ? pageNumber * pageSize
                : totalCount
            }}</strong
          >
          of
          <strong>{{ totalCount }} Results</strong>
        </h5>
        <h5 class="ms-3 text-light" *ngIf="products.length === 0">
          There are
          <strong> 0</strong>
          results for this filter
        </h5>
        <div class="d-flex align-items-center form-inline mt-2">
          <div class="input-group">
            <input
              (keyup.enter)="onSearch()"
              data-bs-theme="dark"
              class="form-control"
              placeholder="Search"
              #search
              type="text"
              style="
                width: 300px;
                outline: none;
                box-shadow: none;
                border: none;
                position: relative;
                border-radius: 5px;
              "
            />
            <div class="input-group-append" data-bs-theme="dark">
              <button
                aria-label="Close"
                class="btn btn-close"
                style="
                  position: absolute;
                  right: 2%;
                  transform: translateY(25%);
                  z-index: 98;
                  outline: none;
                  box-shadow: none;
                "
                type="button"
                (click)="clearSearchInput(search)"
              ></button>
            </div>
          </div>
          <button
            class="btn btn-dark my-2 mx-2"
            type="button"
            (click)="onSearch()"
          >
            Search
          </button>
          <button class="btn btn-dark my-1" type="button" (click)="reset()">
            Reset
          </button>
        </div>
      </div>
      <div
        class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3 mb-5"
        [ngClass]="{ 'sticky-container': products.length < 4 }"
      >
        <div
          class="col"
          *ngFor="
            let product of products
              | paginate
                : {
                    itemsPerPage: pageSize,
                    currentPage: pageNumber,
                    totalItems: totalCount
                  }
          "
        >
          <app-product-item [product]="product"></app-product-item>
        </div>
      </div>
      <h3
        class="d-flex justify-content-center align-items-center h-25 text-light"
        *ngIf="products.length === 0"
      >
        No products found.
      </h3>
    </section>
  </div>
</div>
